(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0cf8a1"],{"63c1":function(s){s.exports=JSON.parse('{"created_at":"2022-01-26T22:45:21+08:00","excerpt":"加里敦大学的生物研究所，发现了决定人喜不喜欢吃藕的基因序列 $S$,有这个序列的碱基序列就会表现出喜欢吃藕的性状，但是研究人员发现对碱基序列 $S$，任意修改其中不超过 $3$ 个碱基，依然能够表现出吃藕的性状。现在研究人员想知道这个基因在 DNA 链 $S_0$ 上的位置。所以你需要统计在一个表现出吃藕性状的人的 DNA 序列 $S_0$ 上，有多少个连续子串可能是该基因，即有多少个 $S_0$ 的连续子串修改小于等于三个字母能够变成 $S$。","html":"<p>加里敦大学的生物研究所，发现了决定人喜不喜欢吃藕的基因序列 <script type=\\"math/tex\\">S<\/script>,有这个序列的碱基序列就会表现出喜欢吃藕的性状，但是研究人员发现对碱基序列 <script type=\\"math/tex\\">S<\/script>，任意修改其中不超过 <script type=\\"math/tex\\">3<\/script> 个碱基，依然能够表现出吃藕的性状。现在研究人员想知道这个基因在 DNA 链 <script type=\\"math/tex\\">S_0<\/script> 上的位置。所以你需要统计在一个表现出吃藕性状的人的 DNA 序列 <script type=\\"math/tex\\">S_0<\/script> 上，有多少个连续子串可能是该基因，即有多少个 <script type=\\"math/tex\\">S_0<\/script> 的连续子串修改小于等于三个字母能够变成 <script type=\\"math/tex\\">S<\/script>。</p>\\n<h2 id=\\"input\\">Input</h2>\\n<p>第一行有一个整数 <script type=\\"math/tex\\">T<\/script>，表示有几组数据。</p>\\n<p>每组数据第一行一个长度不超过 <script type=\\"math/tex\\">10^5<\/script> 的碱基序列 <script type=\\"math/tex\\">S_0<\/script>。</p>\\n<p>每组数据第二行一个长度不超过 <script type=\\"math/tex\\">10^5<\/script> 的吃藕基因序列 <script type=\\"math/tex\\">S<\/script>。</p>\\n<h2 id=\\"output\\">Output</h2>\\n<p>共 <script type=\\"math/tex\\">T<\/script> 行，第 <script type=\\"math/tex\\">i<\/script> 行表示第 <script type=\\"math/tex\\">i<\/script> 组数据中，在 <script type=\\"math/tex\\">S_0<\/script>中有多少个与 <script type=\\"math/tex\\">S<\/script> 等长的连续子串可能是表现吃藕性状的碱基序列。</p>\\n<h2 id=\\"examples\\">Examples</h2>\\n<p>Input</p>\\n<table class=\\"codehilitetable\\"><tr><td class=\\"linenos\\"><div class=\\"linenodiv\\"><pre>1\\n2\\n3</pre></div></td><td class=\\"code\\"><div class=\\"codehilite\\"><pre><span></span><code>1\\nATCGCCCTA\\nCTTCA\\n</code></pre></div>\\n</td></tr></table>\\n\\n<p>Output</p>\\n<table class=\\"codehilitetable\\"><tr><td class=\\"linenos\\"><div class=\\"linenodiv\\"><pre>1</pre></div></td><td class=\\"code\\"><div class=\\"codehilite\\"><pre><span></span><code>2\\n</code></pre></div>\\n</td></tr></table>\\n\\n<h2 id=\\"solution\\">Solution</h2>\\n<p>先把两字符串拼起来求后缀数组，然后枚举 <script type=\\"math/tex\\">S_0<\/script> 的每个位置作为可能的左端点。每次求一下 <script type=\\"math/tex\\">S_0<\/script> 中的当前位置（初始为当前枚举到的位置）和 <script type=\\"math/tex\\">S<\/script> 中的当前位置（初始为 <script type=\\"math/tex\\">S<\/script> 的左端点）的 <script type=\\"math/tex\\">lcp<\/script>，然后跳过去，此时这两个位置一定是需要修改的。如果这样跳的次数不大于 <script type=\\"math/tex\\">4<\/script> 且最终 <script type=\\"math/tex\\">S<\/script> 中的位置到达了最右端，则说明成功。</p>\\n<table class=\\"codehilitetable\\"><tr><td class=\\"linenos\\"><div class=\\"linenodiv\\"><pre> 1\\n 2\\n 3\\n 4\\n 5\\n 6\\n 7\\n 8\\n 9\\n10\\n11\\n12\\n13\\n14\\n15\\n16\\n17\\n18\\n19\\n20\\n21\\n22\\n23\\n24\\n25\\n26\\n27\\n28\\n29\\n30\\n31\\n32\\n33\\n34\\n35\\n36\\n37\\n38\\n39\\n40\\n41\\n42\\n43\\n44\\n45\\n46\\n47\\n48\\n49\\n50\\n51\\n52\\n53\\n54\\n55\\n56\\n57\\n58\\n59\\n60\\n61\\n62\\n63\\n64\\n65\\n66\\n67\\n68\\n69\\n70\\n71\\n72\\n73\\n74\\n75\\n76\\n77\\n78\\n79\\n80\\n81\\n82\\n83\\n84\\n85\\n86\\n87\\n88</pre></div></td><td class=\\"code\\"><div class=\\"codehilite\\"><pre><span></span><code><span class=\\"cp\\">#include</span> <span class=\\"cpf\\">&lt;bits/stdc++.h&gt;</span><span class=\\"cp\\"></span>\\n<span class=\\"k\\">using</span> <span class=\\"k\\">namespace</span> <span class=\\"n\\">std</span><span class=\\"p\\">;</span>\\n\\n<span class=\\"k\\">struct</span> <span class=\\"n\\">ST</span> <span class=\\"p\\">{</span>\\n  <span class=\\"kt\\">int</span> <span class=\\"n\\">n</span><span class=\\"p\\">;</span>\\n  <span class=\\"n\\">vector</span><span class=\\"o\\">&lt;</span><span class=\\"kt\\">int</span><span class=\\"o\\">&gt;</span> <span class=\\"n\\">lg</span><span class=\\"p\\">;</span>\\n  <span class=\\"n\\">vector</span><span class=\\"o\\">&lt;</span><span class=\\"n\\">vector</span><span class=\\"o\\">&lt;</span><span class=\\"kt\\">int</span><span class=\\"o\\">&gt;&gt;</span> <span class=\\"n\\">f</span><span class=\\"p\\">;</span>\\n  <span class=\\"n\\">ST</span><span class=\\"p\\">()</span> <span class=\\"p\\">{}</span>\\n  <span class=\\"n\\">ST</span><span class=\\"p\\">(</span><span class=\\"n\\">vector</span><span class=\\"o\\">&lt;</span><span class=\\"kt\\">int</span><span class=\\"o\\">&gt;&amp;</span> <span class=\\"n\\">a</span><span class=\\"p\\">)</span><span class=\\"o\\">:</span> <span class=\\"n\\">n</span><span class=\\"p\\">(</span><span class=\\"n\\">a</span><span class=\\"p\\">.</span><span class=\\"n\\">size</span><span class=\\"p\\">()),</span> <span class=\\"n\\">lg</span><span class=\\"p\\">(</span><span class=\\"n\\">n</span><span class=\\"o\\">+</span><span class=\\"mi\\">1</span><span class=\\"p\\">),</span> <span class=\\"n\\">f</span><span class=\\"p\\">(</span><span class=\\"n\\">n</span><span class=\\"p\\">)</span> <span class=\\"p\\">{</span>\\n    <span class=\\"k\\">for</span> <span class=\\"p\\">(</span><span class=\\"kt\\">int</span> <span class=\\"n\\">i</span> <span class=\\"o\\">=</span> <span class=\\"mi\\">2</span><span class=\\"p\\">;</span> <span class=\\"n\\">i</span> <span class=\\"o\\">&lt;=</span> <span class=\\"n\\">n</span><span class=\\"p\\">;</span> <span class=\\"n\\">i</span> <span class=\\"o\\">++</span><span class=\\"p\\">)</span> <span class=\\"n\\">lg</span><span class=\\"p\\">[</span><span class=\\"n\\">i</span><span class=\\"p\\">]</span> <span class=\\"o\\">=</span> <span class=\\"n\\">lg</span><span class=\\"p\\">[</span><span class=\\"n\\">i</span><span class=\\"o\\">/</span><span class=\\"mi\\">2</span><span class=\\"p\\">]</span> <span class=\\"o\\">+</span> <span class=\\"mi\\">1</span><span class=\\"p\\">;</span>\\n    <span class=\\"k\\">for</span> <span class=\\"p\\">(</span><span class=\\"kt\\">int</span> <span class=\\"n\\">i</span> <span class=\\"o\\">=</span> <span class=\\"mi\\">0</span><span class=\\"p\\">;</span> <span class=\\"n\\">i</span> <span class=\\"o\\">&lt;</span> <span class=\\"n\\">n</span><span class=\\"p\\">;</span> <span class=\\"n\\">i</span> <span class=\\"o\\">++</span><span class=\\"p\\">)</span> <span class=\\"p\\">{</span>\\n      <span class=\\"n\\">f</span><span class=\\"p\\">[</span><span class=\\"n\\">i</span><span class=\\"p\\">].</span><span class=\\"n\\">resize</span><span class=\\"p\\">(</span><span class=\\"n\\">lg</span><span class=\\"p\\">[</span><span class=\\"n\\">n</span><span class=\\"p\\">]</span><span class=\\"o\\">+</span><span class=\\"mi\\">1</span><span class=\\"p\\">);</span>\\n      <span class=\\"n\\">f</span><span class=\\"p\\">[</span><span class=\\"n\\">i</span><span class=\\"p\\">][</span><span class=\\"mi\\">0</span><span class=\\"p\\">]</span> <span class=\\"o\\">=</span> <span class=\\"n\\">a</span><span class=\\"p\\">[</span><span class=\\"n\\">i</span><span class=\\"p\\">];</span>\\n    <span class=\\"p\\">}</span>\\n    <span class=\\"k\\">for</span> <span class=\\"p\\">(</span><span class=\\"kt\\">int</span> <span class=\\"n\\">j</span> <span class=\\"o\\">=</span> <span class=\\"mi\\">1</span><span class=\\"p\\">;</span> <span class=\\"n\\">j</span> <span class=\\"o\\">&lt;</span> <span class=\\"n\\">f</span><span class=\\"p\\">[</span><span class=\\"mi\\">0</span><span class=\\"p\\">].</span><span class=\\"n\\">size</span><span class=\\"p\\">();</span> <span class=\\"n\\">j</span> <span class=\\"o\\">++</span><span class=\\"p\\">)</span>\\n      <span class=\\"k\\">for</span> <span class=\\"p\\">(</span><span class=\\"kt\\">int</span> <span class=\\"n\\">i</span> <span class=\\"o\\">=</span> <span class=\\"mi\\">0</span><span class=\\"p\\">;</span> <span class=\\"n\\">i</span> <span class=\\"o\\">&lt;</span> <span class=\\"n\\">n</span><span class=\\"p\\">;</span> <span class=\\"n\\">i</span> <span class=\\"o\\">++</span><span class=\\"p\\">)</span>\\n        <span class=\\"n\\">f</span><span class=\\"p\\">[</span><span class=\\"n\\">i</span><span class=\\"p\\">][</span><span class=\\"n\\">j</span><span class=\\"p\\">]</span> <span class=\\"o\\">=</span> <span class=\\"n\\">min</span><span class=\\"p\\">(</span><span class=\\"n\\">f</span><span class=\\"p\\">[</span><span class=\\"n\\">i</span><span class=\\"p\\">][</span><span class=\\"n\\">j</span><span class=\\"o\\">-</span><span class=\\"mi\\">1</span><span class=\\"p\\">],</span> <span class=\\"n\\">f</span><span class=\\"p\\">[</span><span class=\\"n\\">min</span><span class=\\"p\\">(</span><span class=\\"n\\">n</span><span class=\\"o\\">-</span><span class=\\"mi\\">1</span><span class=\\"p\\">,</span> <span class=\\"n\\">i</span><span class=\\"o\\">+</span><span class=\\"p\\">(</span><span class=\\"mi\\">1</span><span class=\\"o\\">&lt;&lt;</span><span class=\\"p\\">(</span><span class=\\"n\\">j</span><span class=\\"o\\">-</span><span class=\\"mi\\">1</span><span class=\\"p\\">)))][</span><span class=\\"n\\">j</span><span class=\\"o\\">-</span><span class=\\"mi\\">1</span><span class=\\"p\\">]);</span>\\n  <span class=\\"p\\">}</span>\\n  <span class=\\"kt\\">int</span> <span class=\\"n\\">query</span><span class=\\"p\\">(</span><span class=\\"kt\\">int</span> <span class=\\"n\\">l</span><span class=\\"p\\">,</span> <span class=\\"kt\\">int</span> <span class=\\"n\\">r</span><span class=\\"p\\">)</span> <span class=\\"p\\">{</span>\\n    <span class=\\"kt\\">int</span> <span class=\\"n\\">k</span> <span class=\\"o\\">=</span> <span class=\\"n\\">lg</span><span class=\\"p\\">[</span><span class=\\"n\\">r</span><span class=\\"o\\">-</span><span class=\\"n\\">l</span><span class=\\"o\\">+</span><span class=\\"mi\\">1</span><span class=\\"p\\">];</span>\\n    <span class=\\"k\\">return</span> <span class=\\"nf\\">min</span><span class=\\"p\\">(</span><span class=\\"n\\">f</span><span class=\\"p\\">[</span><span class=\\"n\\">l</span><span class=\\"p\\">][</span><span class=\\"n\\">k</span><span class=\\"p\\">],</span> <span class=\\"n\\">f</span><span class=\\"p\\">[</span><span class=\\"n\\">r</span><span class=\\"o\\">+</span><span class=\\"mi\\">1</span><span class=\\"o\\">-</span><span class=\\"p\\">(</span><span class=\\"mi\\">1</span><span class=\\"o\\">&lt;&lt;</span><span class=\\"n\\">k</span><span class=\\"p\\">)][</span><span class=\\"n\\">k</span><span class=\\"p\\">]);</span>\\n  <span class=\\"p\\">}</span>\\n<span class=\\"p\\">};</span>\\n\\n<span class=\\"k\\">struct</span> <span class=\\"n\\">SA</span> <span class=\\"p\\">{</span>\\n  <span class=\\"kt\\">int</span> <span class=\\"n\\">n</span><span class=\\"p\\">,</span> <span class=\\"n\\">m</span><span class=\\"p\\">;</span>\\n  <span class=\\"n\\">vector</span><span class=\\"o\\">&lt;</span><span class=\\"kt\\">int</span><span class=\\"o\\">&gt;</span> <span class=\\"n\\">sa</span><span class=\\"p\\">,</span> <span class=\\"n\\">r</span><span class=\\"p\\">,</span> <span class=\\"n\\">rr</span><span class=\\"p\\">,</span> <span class=\\"n\\">ht</span><span class=\\"p\\">,</span> <span class=\\"n\\">idx</span><span class=\\"p\\">;</span>\\n  <span class=\\"n\\">ST</span> <span class=\\"n\\">st</span><span class=\\"p\\">;</span>\\n  <span class=\\"n\\">SA</span><span class=\\"p\\">(</span><span class=\\"k\\">const</span> <span class=\\"n\\">string</span><span class=\\"o\\">&amp;</span> <span class=\\"n\\">s</span><span class=\\"p\\">)</span><span class=\\"o\\">:</span> <span class=\\"n\\">n</span><span class=\\"p\\">(</span><span class=\\"n\\">s</span><span class=\\"p\\">.</span><span class=\\"n\\">size</span><span class=\\"p\\">()),</span> <span class=\\"n\\">sa</span><span class=\\"p\\">(</span><span class=\\"n\\">n</span><span class=\\"p\\">),</span> <span class=\\"n\\">r</span><span class=\\"p\\">(</span><span class=\\"n\\">n</span><span class=\\"o\\">*</span><span class=\\"mi\\">2</span><span class=\\"p\\">),</span> <span class=\\"n\\">rr</span><span class=\\"p\\">(</span><span class=\\"n\\">n</span><span class=\\"o\\">*</span><span class=\\"mi\\">2</span><span class=\\"p\\">),</span> <span class=\\"n\\">ht</span><span class=\\"p\\">(</span><span class=\\"n\\">n</span><span class=\\"p\\">),</span> <span class=\\"n\\">idx</span><span class=\\"p\\">(</span><span class=\\"n\\">n</span><span class=\\"p\\">)</span> <span class=\\"p\\">{</span>\\n    <span class=\\"n\\">m</span> <span class=\\"o\\">=</span> <span class=\\"o\\">*</span><span class=\\"n\\">max_element</span><span class=\\"p\\">(</span><span class=\\"n\\">s</span><span class=\\"p\\">.</span><span class=\\"n\\">begin</span><span class=\\"p\\">(),</span> <span class=\\"n\\">s</span><span class=\\"p\\">.</span><span class=\\"n\\">end</span><span class=\\"p\\">())</span> <span class=\\"o\\">+</span> <span class=\\"mi\\">1</span><span class=\\"p\\">;</span>\\n    <span class=\\"k\\">auto</span> <span class=\\"n\\">rsort</span> <span class=\\"o\\">=</span> <span class=\\"p\\">[</span><span class=\\"o\\">&amp;</span><span class=\\"p\\">]()</span> <span class=\\"p\\">{</span>\\n      <span class=\\"n\\">vector</span><span class=\\"o\\">&lt;</span><span class=\\"kt\\">int</span><span class=\\"o\\">&gt;</span> <span class=\\"n\\">cnt</span><span class=\\"p\\">(</span><span class=\\"n\\">m</span><span class=\\"p\\">);</span>\\n      <span class=\\"k\\">for</span> <span class=\\"p\\">(</span><span class=\\"kt\\">int</span> <span class=\\"n\\">i</span> <span class=\\"o\\">=</span> <span class=\\"mi\\">0</span><span class=\\"p\\">;</span> <span class=\\"n\\">i</span> <span class=\\"o\\">&lt;</span> <span class=\\"n\\">n</span><span class=\\"p\\">;</span> <span class=\\"n\\">i</span> <span class=\\"o\\">++</span><span class=\\"p\\">)</span> <span class=\\"n\\">cnt</span><span class=\\"p\\">[</span><span class=\\"n\\">r</span><span class=\\"p\\">[</span><span class=\\"n\\">i</span><span class=\\"p\\">]]</span> <span class=\\"o\\">++</span><span class=\\"p\\">;</span>\\n      <span class=\\"k\\">for</span> <span class=\\"p\\">(</span><span class=\\"kt\\">int</span> <span class=\\"n\\">i</span> <span class=\\"o\\">=</span> <span class=\\"mi\\">1</span><span class=\\"p\\">;</span> <span class=\\"n\\">i</span> <span class=\\"o\\">&lt;</span> <span class=\\"n\\">m</span><span class=\\"p\\">;</span> <span class=\\"n\\">i</span> <span class=\\"o\\">++</span><span class=\\"p\\">)</span> <span class=\\"n\\">cnt</span><span class=\\"p\\">[</span><span class=\\"n\\">i</span><span class=\\"p\\">]</span> <span class=\\"o\\">+=</span> <span class=\\"n\\">cnt</span><span class=\\"p\\">[</span><span class=\\"n\\">i</span><span class=\\"o\\">-</span><span class=\\"mi\\">1</span><span class=\\"p\\">];</span>\\n      <span class=\\"k\\">for</span> <span class=\\"p\\">(</span><span class=\\"kt\\">int</span> <span class=\\"n\\">i</span> <span class=\\"o\\">=</span> <span class=\\"n\\">n</span><span class=\\"o\\">-</span><span class=\\"mi\\">1</span><span class=\\"p\\">;</span> <span class=\\"n\\">i</span> <span class=\\"o\\">&gt;=</span> <span class=\\"mi\\">0</span><span class=\\"p\\">;</span> <span class=\\"n\\">i</span> <span class=\\"o\\">--</span><span class=\\"p\\">)</span> <span class=\\"n\\">sa</span><span class=\\"p\\">[</span><span class=\\"o\\">--</span><span class=\\"n\\">cnt</span><span class=\\"p\\">[</span><span class=\\"n\\">r</span><span class=\\"p\\">[</span><span class=\\"n\\">idx</span><span class=\\"p\\">[</span><span class=\\"n\\">i</span><span class=\\"p\\">]]]]</span> <span class=\\"o\\">=</span> <span class=\\"n\\">idx</span><span class=\\"p\\">[</span><span class=\\"n\\">i</span><span class=\\"p\\">];</span>\\n    <span class=\\"p\\">};</span>\\n    <span class=\\"k\\">for</span> <span class=\\"p\\">(</span><span class=\\"kt\\">int</span> <span class=\\"n\\">i</span> <span class=\\"o\\">=</span> <span class=\\"mi\\">0</span><span class=\\"p\\">;</span> <span class=\\"n\\">i</span> <span class=\\"o\\">&lt;</span> <span class=\\"n\\">n</span><span class=\\"p\\">;</span> <span class=\\"n\\">i</span> <span class=\\"o\\">++</span><span class=\\"p\\">)</span> <span class=\\"n\\">r</span><span class=\\"p\\">[</span><span class=\\"n\\">i</span><span class=\\"p\\">]</span> <span class=\\"o\\">=</span> <span class=\\"n\\">s</span><span class=\\"p\\">[</span><span class=\\"n\\">i</span><span class=\\"p\\">],</span> <span class=\\"n\\">idx</span><span class=\\"p\\">[</span><span class=\\"n\\">i</span><span class=\\"p\\">]</span> <span class=\\"o\\">=</span> <span class=\\"n\\">i</span><span class=\\"p\\">;</span>\\n    <span class=\\"n\\">rsort</span><span class=\\"p\\">();</span>\\n    <span class=\\"k\\">for</span> <span class=\\"p\\">(</span><span class=\\"kt\\">int</span> <span class=\\"n\\">k</span> <span class=\\"o\\">=</span> <span class=\\"mi\\">1</span><span class=\\"p\\">,</span> <span class=\\"n\\">p</span> <span class=\\"o\\">=</span> <span class=\\"mi\\">0</span><span class=\\"p\\">;</span> <span class=\\"n\\">k</span> <span class=\\"o\\">&lt;</span> <span class=\\"n\\">n</span> <span class=\\"o\\">&amp;&amp;</span> <span class=\\"n\\">p</span> <span class=\\"o\\">&lt;</span> <span class=\\"n\\">n</span><span class=\\"p\\">;</span> <span class=\\"n\\">k</span> <span class=\\"o\\">*=</span> <span class=\\"mi\\">2</span><span class=\\"p\\">,</span> <span class=\\"n\\">m</span> <span class=\\"o\\">=</span> <span class=\\"n\\">p</span><span class=\\"o\\">+</span><span class=\\"mi\\">1</span><span class=\\"p\\">)</span> <span class=\\"p\\">{</span>\\n      <span class=\\"n\\">p</span> <span class=\\"o\\">=</span> <span class=\\"mi\\">0</span><span class=\\"p\\">;</span>\\n      <span class=\\"k\\">for</span> <span class=\\"p\\">(</span><span class=\\"kt\\">int</span> <span class=\\"n\\">i</span> <span class=\\"o\\">=</span> <span class=\\"n\\">n</span><span class=\\"o\\">-</span><span class=\\"n\\">k</span><span class=\\"p\\">;</span> <span class=\\"n\\">i</span> <span class=\\"o\\">&lt;</span> <span class=\\"n\\">n</span><span class=\\"p\\">;</span> <span class=\\"n\\">i</span> <span class=\\"o\\">++</span><span class=\\"p\\">)</span> <span class=\\"n\\">idx</span><span class=\\"p\\">[</span><span class=\\"n\\">p</span><span class=\\"o\\">++</span><span class=\\"p\\">]</span> <span class=\\"o\\">=</span> <span class=\\"n\\">i</span><span class=\\"p\\">;</span>\\n      <span class=\\"k\\">for</span> <span class=\\"p\\">(</span><span class=\\"k\\">auto</span> <span class=\\"nl\\">i</span><span class=\\"p\\">:</span> <span class=\\"n\\">sa</span><span class=\\"p\\">)</span> <span class=\\"k\\">if</span> <span class=\\"p\\">(</span><span class=\\"n\\">i</span> <span class=\\"o\\">&gt;=</span> <span class=\\"n\\">k</span><span class=\\"p\\">)</span> <span class=\\"n\\">idx</span><span class=\\"p\\">[</span><span class=\\"n\\">p</span><span class=\\"o\\">++</span><span class=\\"p\\">]</span> <span class=\\"o\\">=</span> <span class=\\"n\\">i</span><span class=\\"o\\">-</span><span class=\\"n\\">k</span><span class=\\"p\\">;</span>\\n      <span class=\\"n\\">rsort</span><span class=\\"p\\">(),</span> <span class=\\"n\\">swap</span><span class=\\"p\\">(</span><span class=\\"n\\">r</span><span class=\\"p\\">,</span> <span class=\\"n\\">rr</span><span class=\\"p\\">),</span> <span class=\\"n\\">p</span> <span class=\\"o\\">=</span> <span class=\\"n\\">r</span><span class=\\"p\\">[</span><span class=\\"n\\">sa</span><span class=\\"p\\">[</span><span class=\\"mi\\">0</span><span class=\\"p\\">]]</span> <span class=\\"o\\">=</span> <span class=\\"mi\\">1</span><span class=\\"p\\">;</span>\\n      <span class=\\"k\\">for</span> <span class=\\"p\\">(</span><span class=\\"kt\\">int</span> <span class=\\"n\\">i</span> <span class=\\"o\\">=</span> <span class=\\"mi\\">1</span><span class=\\"p\\">;</span> <span class=\\"n\\">i</span> <span class=\\"o\\">&lt;</span> <span class=\\"n\\">n</span><span class=\\"p\\">;</span> <span class=\\"n\\">i</span> <span class=\\"o\\">++</span><span class=\\"p\\">)</span>\\n        <span class=\\"n\\">r</span><span class=\\"p\\">[</span><span class=\\"n\\">sa</span><span class=\\"p\\">[</span><span class=\\"n\\">i</span><span class=\\"p\\">]]</span> <span class=\\"o\\">=</span> <span class=\\"n\\">rr</span><span class=\\"p\\">[</span><span class=\\"n\\">sa</span><span class=\\"p\\">[</span><span class=\\"n\\">i</span><span class=\\"p\\">]]</span> <span class=\\"o\\">==</span> <span class=\\"n\\">rr</span><span class=\\"p\\">[</span><span class=\\"n\\">sa</span><span class=\\"p\\">[</span><span class=\\"n\\">i</span><span class=\\"o\\">-</span><span class=\\"mi\\">1</span><span class=\\"p\\">]]</span> <span class=\\"o\\">&amp;&amp;</span> <span class=\\"n\\">rr</span><span class=\\"p\\">[</span><span class=\\"n\\">sa</span><span class=\\"p\\">[</span><span class=\\"n\\">i</span><span class=\\"p\\">]</span><span class=\\"o\\">+</span><span class=\\"n\\">k</span><span class=\\"p\\">]</span> <span class=\\"o\\">==</span> <span class=\\"n\\">rr</span><span class=\\"p\\">[</span><span class=\\"n\\">sa</span><span class=\\"p\\">[</span><span class=\\"n\\">i</span><span class=\\"o\\">-</span><span class=\\"mi\\">1</span><span class=\\"p\\">]</span><span class=\\"o\\">+</span><span class=\\"n\\">k</span><span class=\\"p\\">]</span> <span class=\\"o\\">?</span> <span class=\\"nl\\">p</span><span class=\\"p\\">:</span> <span class=\\"o\\">++</span><span class=\\"n\\">p</span><span class=\\"p\\">;</span>\\n    <span class=\\"p\\">}</span>\\n    <span class=\\"k\\">for</span> <span class=\\"p\\">(</span><span class=\\"kt\\">int</span> <span class=\\"n\\">i</span> <span class=\\"o\\">=</span> <span class=\\"mi\\">0</span><span class=\\"p\\">;</span> <span class=\\"n\\">i</span> <span class=\\"o\\">&lt;</span> <span class=\\"n\\">n</span><span class=\\"p\\">;</span> <span class=\\"n\\">i</span> <span class=\\"o\\">++</span><span class=\\"p\\">)</span> <span class=\\"n\\">r</span><span class=\\"p\\">[</span><span class=\\"n\\">sa</span><span class=\\"p\\">[</span><span class=\\"n\\">i</span><span class=\\"p\\">]]</span> <span class=\\"o\\">=</span> <span class=\\"n\\">i</span><span class=\\"p\\">;</span>\\n    <span class=\\"k\\">for</span> <span class=\\"p\\">(</span><span class=\\"kt\\">int</span> <span class=\\"n\\">k</span> <span class=\\"o\\">=</span> <span class=\\"mi\\">0</span><span class=\\"p\\">,</span> <span class=\\"n\\">i</span> <span class=\\"o\\">=</span> <span class=\\"mi\\">0</span><span class=\\"p\\">;</span> <span class=\\"n\\">i</span> <span class=\\"o\\">&lt;</span> <span class=\\"n\\">n</span><span class=\\"p\\">;</span> <span class=\\"n\\">i</span> <span class=\\"o\\">++</span><span class=\\"p\\">)</span> <span class=\\"p\\">{</span>\\n      <span class=\\"k\\">if</span> <span class=\\"p\\">(</span><span class=\\"n\\">r</span><span class=\\"p\\">[</span><span class=\\"n\\">i</span><span class=\\"p\\">])</span> <span class=\\"p\\">{</span>\\n        <span class=\\"k\\">if</span> <span class=\\"p\\">(</span><span class=\\"n\\">k</span><span class=\\"p\\">)</span> <span class=\\"o\\">--</span><span class=\\"n\\">k</span><span class=\\"p\\">;</span>\\n        <span class=\\"k\\">for</span> <span class=\\"p\\">(</span><span class=\\"kt\\">int</span> <span class=\\"n\\">j</span> <span class=\\"o\\">=</span> <span class=\\"n\\">sa</span><span class=\\"p\\">[</span><span class=\\"n\\">r</span><span class=\\"p\\">[</span><span class=\\"n\\">i</span><span class=\\"p\\">]</span><span class=\\"o\\">-</span><span class=\\"mi\\">1</span><span class=\\"p\\">];</span> <span class=\\"n\\">i</span><span class=\\"o\\">+</span><span class=\\"n\\">k</span> <span class=\\"o\\">&lt;</span> <span class=\\"n\\">n</span> <span class=\\"o\\">&amp;&amp;</span> <span class=\\"n\\">j</span><span class=\\"o\\">+</span><span class=\\"n\\">k</span> <span class=\\"o\\">&lt;</span> <span class=\\"n\\">n</span> <span class=\\"o\\">&amp;&amp;</span> <span class=\\"n\\">s</span><span class=\\"p\\">[</span><span class=\\"n\\">i</span><span class=\\"o\\">+</span><span class=\\"n\\">k</span><span class=\\"p\\">]</span> <span class=\\"o\\">==</span> <span class=\\"n\\">s</span><span class=\\"p\\">[</span><span class=\\"n\\">j</span><span class=\\"o\\">+</span><span class=\\"n\\">k</span><span class=\\"p\\">];</span> <span class=\\"n\\">k</span><span class=\\"o\\">++</span><span class=\\"p\\">)</span> <span class=\\"p\\">;</span>\\n      <span class=\\"p\\">}</span>\\n      <span class=\\"k\\">else</span> <span class=\\"n\\">k</span> <span class=\\"o\\">=</span> <span class=\\"mi\\">0</span><span class=\\"p\\">;</span>\\n      <span class=\\"n\\">ht</span><span class=\\"p\\">[</span><span class=\\"n\\">r</span><span class=\\"p\\">[</span><span class=\\"n\\">i</span><span class=\\"p\\">]]</span> <span class=\\"o\\">=</span> <span class=\\"n\\">k</span><span class=\\"p\\">;</span>\\n    <span class=\\"p\\">}</span>\\n    <span class=\\"n\\">st</span> <span class=\\"o\\">=</span> <span class=\\"n\\">ST</span><span class=\\"p\\">(</span><span class=\\"n\\">ht</span><span class=\\"p\\">);</span>\\n  <span class=\\"p\\">}</span>\\n  <span class=\\"kt\\">int</span> <span class=\\"n\\">lcp</span><span class=\\"p\\">(</span><span class=\\"kt\\">int</span> <span class=\\"n\\">i</span><span class=\\"p\\">,</span> <span class=\\"kt\\">int</span> <span class=\\"n\\">j</span><span class=\\"p\\">)</span> <span class=\\"p\\">{</span>\\n    <span class=\\"k\\">if</span> <span class=\\"p\\">(</span><span class=\\"n\\">i</span> <span class=\\"o\\">==</span> <span class=\\"n\\">j</span><span class=\\"p\\">)</span> <span class=\\"k\\">return</span> <span class=\\"n\\">n</span><span class=\\"o\\">-</span><span class=\\"n\\">i</span><span class=\\"p\\">;</span>\\n    <span class=\\"k\\">if</span> <span class=\\"p\\">(</span><span class=\\"n\\">r</span><span class=\\"p\\">[</span><span class=\\"n\\">i</span><span class=\\"p\\">]</span> <span class=\\"o\\">&gt;</span> <span class=\\"n\\">r</span><span class=\\"p\\">[</span><span class=\\"n\\">j</span><span class=\\"p\\">])</span> <span class=\\"n\\">swap</span><span class=\\"p\\">(</span><span class=\\"n\\">i</span><span class=\\"p\\">,</span> <span class=\\"n\\">j</span><span class=\\"p\\">);</span>\\n    <span class=\\"k\\">return</span> <span class=\\"n\\">st</span><span class=\\"p\\">.</span><span class=\\"n\\">query</span><span class=\\"p\\">(</span><span class=\\"n\\">r</span><span class=\\"p\\">[</span><span class=\\"n\\">i</span><span class=\\"p\\">]</span><span class=\\"o\\">+</span><span class=\\"mi\\">1</span><span class=\\"p\\">,</span> <span class=\\"n\\">r</span><span class=\\"p\\">[</span><span class=\\"n\\">j</span><span class=\\"p\\">]);</span>\\n  <span class=\\"p\\">}</span>\\n<span class=\\"p\\">};</span>\\n\\n<span class=\\"kt\\">int</span> <span class=\\"nf\\">main</span><span class=\\"p\\">()</span> <span class=\\"p\\">{</span>\\n  <span class=\\"kt\\">int</span> <span class=\\"n\\">nt</span><span class=\\"p\\">;</span>\\n  <span class=\\"n\\">cin</span> <span class=\\"o\\">&gt;&gt;</span> <span class=\\"n\\">nt</span><span class=\\"p\\">;</span>\\n  <span class=\\"k\\">while</span> <span class=\\"p\\">(</span><span class=\\"n\\">nt</span> <span class=\\"o\\">--</span><span class=\\"p\\">)</span> <span class=\\"p\\">{</span>\\n    <span class=\\"n\\">string</span> <span class=\\"n\\">s</span><span class=\\"p\\">,</span> <span class=\\"n\\">t</span><span class=\\"p\\">;</span>\\n    <span class=\\"n\\">cin</span> <span class=\\"o\\">&gt;&gt;</span> <span class=\\"n\\">s</span> <span class=\\"o\\">&gt;&gt;</span> <span class=\\"n\\">t</span><span class=\\"p\\">;</span>\\n    <span class=\\"n\\">SA</span> <span class=\\"n\\">sa</span><span class=\\"p\\">(</span><span class=\\"n\\">s</span> <span class=\\"o\\">+</span> <span class=\\"sc\\">&#39;#&#39;</span> <span class=\\"o\\">+</span> <span class=\\"n\\">t</span> <span class=\\"o\\">+</span> <span class=\\"sc\\">&#39;$&#39;</span><span class=\\"p\\">);</span>\\n    <span class=\\"kt\\">int</span> <span class=\\"n\\">sl</span> <span class=\\"o\\">=</span> <span class=\\"n\\">s</span><span class=\\"p\\">.</span><span class=\\"n\\">size</span><span class=\\"p\\">(),</span> <span class=\\"n\\">tl</span> <span class=\\"o\\">=</span> <span class=\\"n\\">t</span><span class=\\"p\\">.</span><span class=\\"n\\">size</span><span class=\\"p\\">();</span>\\n    <span class=\\"kt\\">int</span> <span class=\\"n\\">cnt</span> <span class=\\"o\\">=</span> <span class=\\"mi\\">0</span><span class=\\"p\\">;</span>\\n    <span class=\\"k\\">for</span> <span class=\\"p\\">(</span><span class=\\"kt\\">int</span> <span class=\\"n\\">ii</span> <span class=\\"o\\">=</span> <span class=\\"mi\\">0</span><span class=\\"p\\">;</span> <span class=\\"n\\">ii</span> <span class=\\"o\\">&lt;</span> <span class=\\"n\\">sl</span><span class=\\"p\\">;</span> <span class=\\"n\\">ii</span> <span class=\\"o\\">++</span><span class=\\"p\\">)</span> <span class=\\"p\\">{</span>\\n      <span class=\\"kt\\">int</span> <span class=\\"n\\">i</span> <span class=\\"o\\">=</span> <span class=\\"n\\">ii</span><span class=\\"p\\">,</span> <span class=\\"n\\">j</span> <span class=\\"o\\">=</span> <span class=\\"n\\">sl</span> <span class=\\"o\\">+</span> <span class=\\"mi\\">1</span><span class=\\"p\\">;</span>\\n      <span class=\\"kt\\">int</span> <span class=\\"n\\">lcp</span> <span class=\\"o\\">=</span> <span class=\\"n\\">sa</span><span class=\\"p\\">.</span><span class=\\"n\\">lcp</span><span class=\\"p\\">(</span><span class=\\"n\\">i</span><span class=\\"p\\">,</span> <span class=\\"n\\">j</span><span class=\\"p\\">);</span>\\n      <span class=\\"n\\">i</span> <span class=\\"o\\">+=</span> <span class=\\"n\\">lcp</span><span class=\\"p\\">,</span> <span class=\\"n\\">j</span> <span class=\\"o\\">+=</span> <span class=\\"n\\">lcp</span><span class=\\"p\\">;</span>\\n      <span class=\\"k\\">for</span> <span class=\\"p\\">(</span><span class=\\"kt\\">int</span> <span class=\\"n\\">k</span> <span class=\\"o\\">=</span> <span class=\\"mi\\">0</span><span class=\\"p\\">;</span> <span class=\\"n\\">i</span> <span class=\\"o\\">&lt;</span> <span class=\\"n\\">sl</span> <span class=\\"o\\">&amp;&amp;</span> <span class=\\"n\\">j</span> <span class=\\"o\\">&lt;=</span> <span class=\\"n\\">sl</span><span class=\\"o\\">+</span><span class=\\"n\\">tl</span> <span class=\\"o\\">&amp;&amp;</span> <span class=\\"n\\">k</span> <span class=\\"o\\">&lt;</span> <span class=\\"mi\\">3</span><span class=\\"p\\">;</span> <span class=\\"n\\">k</span> <span class=\\"o\\">++</span><span class=\\"p\\">)</span> <span class=\\"p\\">{</span>\\n        <span class=\\"n\\">i</span> <span class=\\"o\\">++</span><span class=\\"p\\">,</span> <span class=\\"n\\">j</span> <span class=\\"o\\">++</span><span class=\\"p\\">;</span>\\n        <span class=\\"kt\\">int</span> <span class=\\"n\\">nxt</span> <span class=\\"o\\">=</span> <span class=\\"n\\">sa</span><span class=\\"p\\">.</span><span class=\\"n\\">lcp</span><span class=\\"p\\">(</span><span class=\\"n\\">i</span><span class=\\"p\\">,</span> <span class=\\"n\\">j</span><span class=\\"p\\">);</span>\\n        <span class=\\"n\\">i</span> <span class=\\"o\\">+=</span> <span class=\\"n\\">nxt</span><span class=\\"p\\">,</span> <span class=\\"n\\">j</span> <span class=\\"o\\">+=</span> <span class=\\"n\\">nxt</span><span class=\\"p\\">;</span>\\n      <span class=\\"p\\">}</span>\\n      <span class=\\"k\\">if</span> <span class=\\"p\\">(</span><span class=\\"n\\">j</span> <span class=\\"o\\">==</span> <span class=\\"n\\">sl</span><span class=\\"o\\">+</span><span class=\\"n\\">tl</span><span class=\\"o\\">+</span><span class=\\"mi\\">1</span><span class=\\"p\\">)</span> <span class=\\"n\\">cnt</span> <span class=\\"o\\">++</span><span class=\\"p\\">;</span>\\n    <span class=\\"p\\">}</span>\\n    <span class=\\"n\\">cout</span> <span class=\\"o\\">&lt;&lt;</span> <span class=\\"n\\">cnt</span> <span class=\\"o\\">&lt;&lt;</span> <span class=\\"sc\\">&#39;\\\\n&#39;</span><span class=\\"p\\">;</span>\\n  <span class=\\"p\\">}</span>\\n  <span class=\\"k\\">return</span> <span class=\\"mi\\">0</span><span class=\\"p\\">;</span>\\n<span class=\\"p\\">}</span>\\n</code></pre></div>\\n</td></tr></table>","tags":[{"name":"strings","url":"/tags/strings"}],"title":"TJOI-2017 DNA","updated_at":"2022-01-26T22:45:21+08:00","url":"/docs/strings/suffix-array/luogu-3763"}')}}]);
//# sourceMappingURL=chunk-2d0cf8a1.d0d3e28e.js.map